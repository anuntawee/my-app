name: Run on Tag Version

on:
  workflow_dispatch:
    inputs:
      selected_tag:
        description: 'Select a tag version'
        required: true

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Get Tags from GitHub API
      id: get_tags
      run: |
        TAGS=$(curl -s "https://api.github.com/repos/anuntawee/my-app/tags" | jq -r '.[].name')
        echo "::set-output name=tags::$TAGS"

    - name: Checkout code
      uses: actions/checkout@v2

    - name: Build and Deploy
      run: |
        TAGS=${{ steps.get_tags.outputs.tags }}
        echo "Available tags: $TAGS"

        # ทำงานเพื่อดึง "tag version" ที่ผู้ใช้เลือก
        SELECTED_TAG=${{ github.event.inputs.selected_tag }}

        echo "Building and deploying for selected tag: $SELECTED_TAG"
